---
import EditorLayout from "@layouts/EditorLayout.astro"

import { sections } from "@data/cv/sections.json"
import { links } from "@data/links.json"

export function getStaticPaths() {
  return sections.map(section => {
    return { params: { section: section.name.toLocaleLowerCase() } }
  })
}

function capitalize(str) {
  return str.charAt(0).toUpperCase() + str.slice(1)
}

const { section: current_tab_name } = Astro.params;

const tabs = sections.map(section => {
  return {
    ...section,
    link: `/cv/${section.name.toLowerCase()}`
  }
})

const current_tab = tabs.find(tab => tab.name === capitalize(current_tab_name))
---

<EditorLayout current_tab={current_tab} extension="cv" links={links} tabs={tabs} print>
  {async () => {
  const DynamicComponent = (await import(`../../components/cv/${current_tab.name}.astro`)).default
  return <>
    <DynamicComponent />
  </>
  }}
</EditorLayout>